# GlowUS Living Knowledge Agent 기획서

> **"옵시디언은 당신의 기억을 저장하고, GlowUS는 당신과 함께 생각한다"**

---

## 1. 비전

### 1.1 문제 정의
| 기존 노트 앱 (옵시디언) | 한계 |
|------------------------|------|
| 사용자가 직접 `[[링크]]` 작성 | 관계를 놓침 |
| 검색해서 찾아야 함 | 시간 낭비 |
| 그래프는 시각화만 | 인사이트 없음 |
| 노트는 정적 | 오래되면 쓸모없음 |
| 코드와 문서 분리 | 동기화 안됨 |

### 1.2 GlowUS 솔루션
```
옵시디언: 당신이 적는다 → 저장된다 → 끝
GlowUS:   당신이 적는다 → AI가 이해한다 → 스스로 진화한다
```

### 1.3 핵심 가치
- **Proactive**: AI가 먼저 제안 (수동 검색 X)
- **Connected**: 모든 지식이 자동 연결
- **Living**: 문서가 스스로 업데이트
- **Integrated**: 코드와 문서가 하나

---

## 2. 핵심 기능

### 2.1 Second Brain Agent

#### 2.1.1 모순/불일치 자동 감지
```
┌──────────────────────────────────────────────────────┐
│ ⚠️ 불일치 감지                                        │
│                                                      │
│ "회의록.md"에서: API 방식 = REST                      │
│ "기획서.md"에서: API 방식 = GraphQL                   │
│                                                      │
│ 3월 15일 vs 3월 20일 작성 - 최신 결정이 뭔가요?        │
│                                                      │
│ [회의록 열기] [기획서 열기] [불일치 해결하기]          │
└──────────────────────────────────────────────────────┘
```

**구현 방식:**
1. 문서 저장 시 핵심 정보 추출 (키워드, 결정사항, 수치)
2. 임베딩으로 유사 문서 검색
3. 동일 주제에 대해 다른 값 감지
4. 사용자에게 알림

#### 2.1.2 연관 문서 자동 발견
```
┌──────────────────────────────────────────────────────┐
│ 💡 연관 문서 발견                                     │
│                                                      │
│ 현재 문서: "결제 시스템 설계.md"                       │
│                                                      │
│ 관련 있어 보이는 문서:                                │
│ • PG사 비교.md (87% 연관)                            │
│ • 보안 정책.md (72% 연관)                            │
│ • 2024-03 회의록.md (65% 연관)                       │
│                                                      │
│ [연결하기] [무시]                                     │
└──────────────────────────────────────────────────────┘
```

**구현 방식:**
1. 문서별 임베딩 벡터 생성 (OpenAI/로컬 모델)
2. 코사인 유사도로 관련 문서 검색
3. 명시적 링크 없어도 관계 표시
4. 그래프에 점선으로 "잠재적 연결" 표시

#### 2.1.3 예측 제안
```
┌──────────────────────────────────────────────────────┐
│ 🔮 예측 제안                                          │
│                                                      │
│ "결제 시스템 설계" 작업 중이시네요.                    │
│                                                      │
│ 다음 문서가 필요할 것 같아요:                         │
│ • [ ] 에러 처리 정책                                 │
│ • [ ] 테스트 케이스                                  │
│ • [ ] 롤백 절차                                      │
│                                                      │
│ [템플릿으로 생성] [나중에]                            │
└──────────────────────────────────────────────────────┘
```

**구현 방식:**
1. 유사 프로젝트 패턴 학습
2. 현재 문서 타입 분석
3. 일반적으로 함께 작성되는 문서 추천

---

### 2.2 Code ↔ Knowledge Sync

#### 2.2.1 코드 주석 → 문서 자동 연결
```typescript
// 코드에서
/**
 * @doc 결제시스템_기획서.md
 * @decision 2024-03-15 PG사를 토스페이먼츠로 결정
 */
function processPayment() { ... }
```

```markdown
<!-- 문서에서 자동 표시 -->
## 관련 코드
| 파일 | 함수 | 마지막 수정 |
|------|------|------------|
| payment.ts | processPayment() | 2시간 전 ⚠️ |
| refund.ts | processRefund() | 3일 전 ✅ |

⚠️ payment.ts가 수정됨 - 문서 업데이트 필요?
```

#### 2.2.2 코드 변경 감지 → 문서 업데이트 알림
```
┌──────────────────────────────────────────────────────┐
│ 📝 문서 업데이트 필요                                 │
│                                                      │
│ payment.ts 변경됨:                                   │
│ - processPayment() 파라미터 추가                     │
│ - 새 함수 validateCard() 추가                        │
│                                                      │
│ 연결된 문서:                                         │
│ • 결제시스템_기획서.md                               │
│ • API_명세서.md                                      │
│                                                      │
│ [문서 업데이트] [변경사항 보기] [무시]                │
└──────────────────────────────────────────────────────┘
```

---

### 2.3 Smart Properties (YAML Frontmatter)

#### 2.3.1 UI 설계
```
┌─────────────────────────────────────────┐
│ Properties                        ✨ AI │
├─────────────────────────────────────────┤
│ ≡ type      [회의록      ▼]            │ ← 드롭다운
│ ≡ tags      [업무] [중요] [+]          │ ← 태그 입력
│ ≡ date      [2024-12-27  📅]           │ ← 날짜 피커
│ ≡ status    [진행중      ▼]            │ ← 드롭다운
│ ≡ author    [@홍길동    ▼]             │ ← 멘션
│ ≡ related   [기획서.md] [회의록.md]    │ ← 문서 링크
│                                         │
│ ┌─────────────────────────────────────┐ │
│ │ 💡 AI 추천 (본문 분석 결과)          │ │
│ │                                     │ │
│ │ + priority: 높음                    │ │
│ │ + deadline: 2024-12-30              │ │
│ │ + project: 결제시스템               │ │
│ │                                     │ │
│ │ [모두 적용] 또는 개별 클릭           │ │
│ └─────────────────────────────────────┘ │
│                                         │
│ [+ Add property]                        │
└─────────────────────────────────────────┘
```

#### 2.3.2 Property 타입
| 타입 | UI | 예시 |
|------|-----|------|
| text | 텍스트 입력 | author: 홍길동 |
| number | 숫자 입력 | priority: 1 |
| date | 날짜 피커 | date: 2024-12-27 |
| datetime | 날짜+시간 | created: 2024-12-27T10:00 |
| checkbox | 체크박스 | done: true |
| select | 드롭다운 | status: [진행중, 완료, 보류] |
| multiselect | 다중 선택 | tags: [업무, 중요] |
| link | 문서 링크 | related: [[기획서.md]] |
| user | 사용자 멘션 | assignee: @홍길동 |

#### 2.3.3 AI 추천 로직
```
1. 본문 텍스트 분석
2. 기존 문서들의 Property 패턴 학습
3. 유사 문서에서 자주 사용된 Property 추천
4. 본문에서 날짜, 사람 이름, 키워드 자동 추출
```

---

## 3. 데이터 아키텍처

### 3.1 문서 저장 구조
```yaml
# 파일: notes/회의록.md
---
id: doc_abc123
type: meeting
title: 결제 시스템 회의
date: 2024-12-27
tags: [결제, 기획]
status: 진행중
author: 홍길동
related:
  - doc_xyz789  # 기획서
  - doc_def456  # API 명세
ai_extracted:
  keywords: [PG사, 토스페이먼츠, REST API]
  decisions: ["PG사를 토스페이먼츠로 결정"]
  action_items: ["API 명세서 작성", "보안 검토"]
embedding_id: emb_123456
---

# 결제 시스템 회의

본문 내용...
```

### 3.2 인덱스 구조 (JSON)
```json
{
  "documents": {
    "doc_abc123": {
      "title": "결제 시스템 회의",
      "path": "notes/회의록.md",
      "type": "meeting",
      "tags": ["결제", "기획"],
      "links": ["doc_xyz789", "doc_def456"],
      "backlinks": ["doc_ghi012"],
      "embedding_id": "emb_123456",
      "extracted": {
        "keywords": ["PG사", "토스페이먼츠"],
        "decisions": [...],
        "code_refs": ["payment.ts:processPayment"]
      },
      "updated_at": "2024-12-27T10:00:00Z"
    }
  },
  "embeddings": {
    "emb_123456": [0.123, -0.456, ...]
  },
  "code_links": {
    "payment.ts:processPayment": ["doc_abc123", "doc_xyz789"]
  }
}
```

### 3.3 코드-문서 연결 구조
```json
{
  "code_docs": {
    "payment.ts": {
      "functions": {
        "processPayment": {
          "line": 45,
          "docs": ["결제시스템_기획서.md"],
          "last_modified": "2024-12-27T08:00:00Z"
        }
      },
      "last_modified": "2024-12-27T08:00:00Z"
    }
  },
  "doc_codes": {
    "결제시스템_기획서.md": {
      "code_refs": [
        { "file": "payment.ts", "function": "processPayment", "line": 45 }
      ],
      "stale": true  // 코드가 더 최신
    }
  }
}
```

---

## 4. AI 파이프라인

### 4.1 문서 저장 시 처리 흐름
```
문서 저장
    │
    ▼
┌─────────────┐
│ YAML 파싱   │ → Properties 추출
└─────────────┘
    │
    ▼
┌─────────────┐
│ 본문 분석   │ → 키워드, 결정사항, 액션아이템 추출
└─────────────┘
    │
    ▼
┌─────────────┐
│ 임베딩 생성 │ → 벡터 DB 저장
└─────────────┘
    │
    ▼
┌─────────────┐
│ 관계 분석   │ → 유사 문서 검색, 모순 감지
└─────────────┘
    │
    ▼
┌─────────────┐
│ 코드 연결   │ → @doc 주석 파싱, 연결 업데이트
└─────────────┘
    │
    ▼
┌─────────────┐
│ 인덱스 업데이트 │
└─────────────┘
```

### 4.2 AI 추천 생성 흐름
```
문서 열기/작성 중
    │
    ▼
┌─────────────────┐
│ 현재 본문 분석   │
└─────────────────┘
    │
    ├─→ Property 추천 (태그, 상태, 날짜 등)
    │
    ├─→ 연관 문서 추천 (임베딩 유사도)
    │
    ├─→ 모순 감지 (동일 주제 다른 값)
    │
    └─→ 예측 제안 (다음 필요한 문서)
```

### 4.3 사용할 AI 모델
| 용도 | 모델 | 이유 |
|------|------|------|
| 임베딩 | OpenAI text-embedding-3-small | 빠르고 저렴 |
| 키워드 추출 | GPT-4o-mini | 정확도 높음 |
| 모순 감지 | GPT-4o | 복잡한 추론 필요 |
| Property 추천 | GPT-4o-mini | 빠른 응답 |

---

## 5. UI/UX 설계

### 5.1 메인 화면 구조
```
┌─────────────────────────────────────────────────────────────┐
│ GlowUS                                    [🔍] [⚙️] [👤]    │
├─────────┬───────────────────────────────────┬───────────────┤
│         │                                   │               │
│ 📁 Files│     Editor / Preview              │  🤖 Agent     │
│         │                                   │               │
│ 📄 Note1│  ┌─────────────────────────────┐  │  💡 추천      │
│ 📄 Note2│  │ Properties          [✨ AI] │  │  ├ 태그: 업무 │
│ 📁 Folder│  ├─────────────────────────────┤  │  ├ 관련: 2개 │
│   └ Note3│  │                             │  │  └ 모순: 1개 │
│         │  │  # 제목                      │  │               │
│         │  │                             │  │  ⚠️ 알림      │
│         │  │  본문 내용...                │  │  └ API 불일치 │
│         │  │                             │  │               │
│         │  └─────────────────────────────┘  │  💬 Chat      │
│         │                                   │  [입력...]    │
├─────────┴───────────────────────────────────┴───────────────┤
│ Graph View                                                  │
│    ○──○──○                                                  │
│      ╲│╱                                                    │
│       ○ (점선: AI 발견 관계)                                │
└─────────────────────────────────────────────────────────────┘
```

### 5.2 Agent 알림 패널
```
┌─────────────────────────────────────┐
│ 🤖 Agent                      [─]   │
├─────────────────────────────────────┤
│                                     │
│ ⚠️ 모순 감지 (1)                    │
│ ├ 회의록 vs 기획서: API 방식 다름   │
│ └ [해결하기]                        │
│                                     │
│ 💡 연관 문서 (3)                    │
│ ├ PG사 비교.md (87%)               │
│ ├ 보안 정책.md (72%)               │
│ └ [모두 연결]                       │
│                                     │
│ 🔮 제안                             │
│ ├ "에러 처리 정책" 문서 필요?       │
│ └ [생성하기] [무시]                 │
│                                     │
│ 📝 업데이트 필요 (2)                │
│ ├ payment.ts 변경됨                │
│ └ [문서 업데이트]                   │
│                                     │
└─────────────────────────────────────┘
```

---

## 6. 구현 로드맵

### Phase 1: 기반 구축 (2주)
- [ ] YAML frontmatter 파서 구현
- [ ] Properties UI 컴포넌트 (수동 입력)
- [ ] 문서 인덱스 구조 설계
- [ ] 기본 저장/로드 파이프라인

### Phase 2: AI 기본 기능 (3주)
- [ ] 임베딩 생성 및 저장
- [ ] 유사 문서 검색
- [ ] Property AI 추천
- [ ] Agent 패널 UI

### Phase 3: 모순 감지 (2주)
- [ ] 키워드/결정사항 추출
- [ ] 동일 주제 문서 비교
- [ ] 모순 알림 UI
- [ ] 해결 워크플로우

### Phase 4: 코드 연결 (3주)
- [ ] @doc 주석 파서
- [ ] 코드 변경 감지 (파일 워처)
- [ ] 코드-문서 연결 UI
- [ ] 업데이트 알림

### Phase 5: 고급 기능 (2주)
- [ ] 예측 제안
- [ ] 그래프에 AI 관계 표시
- [ ] 팀 협업 기능

---

## 7. 기술 스택

| 영역 | 기술 | 이유 |
|------|------|------|
| Frontend | React + TypeScript | 기존 스택 |
| State | Zustand | 기존 스택 |
| AI | OpenAI API | 임베딩 + GPT |
| Vector DB | 로컬 JSON (초기) → Supabase pgvector | 확장성 |
| 코드 파싱 | TypeScript Compiler API | AST 분석 |
| 파일 감시 | chokidar (Electron) | 변경 감지 |

---

## 8. 성공 지표

| 지표 | 목표 |
|------|------|
| 자동 연결 정확도 | > 80% |
| 모순 감지율 | > 70% |
| AI 추천 채택률 | > 50% |
| 문서 작성 시간 단축 | 30% |

---

## 9. 리스크 및 대응

| 리스크 | 확률 | 대응 |
|--------|------|------|
| AI 오탐 (잘못된 추천) | 높음 | 항상 사용자 확인 후 적용 |
| 성능 저하 (대량 문서) | 중간 | 배치 처리, 캐싱 |
| API 비용 | 중간 | 로컬 모델 대안, 캐싱 |
| 복잡한 코드 파싱 실패 | 높음 | 기본 패턴만 지원, 점진적 확장 |

---

## 10. 다음 단계

1. 이 문서 컨펌
2. Phase 1 상세 설계
3. 구현 시작

---

*작성일: 2024-12-27*
*버전: 1.0*
